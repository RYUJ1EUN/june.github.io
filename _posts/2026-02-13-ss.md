---
layout: post
title: "Secret Sharing"
date: 2026-02-13
description: "Paper review regarding the secret sharing"
tags: [Cryptography, SS]
categories: [Study]
---

üìñ Adi Shamir, "How to Share a Secret",  Communications of the ACM, Vol.22, No.11, 1979.

This technique enables the construction of robust key management schemes for cryptographic systems that can function securely and reliably even when misfortunes destroy half the pieces and security breaches expose all but one of the remaining pieces.

1. knowledge of any $k$ or more $D_i$ pieces makes $D$ easily computable;

2. knowledge of any $k-1$ or fewer $D_i$ pieces leaves $D$ completely undetermined (in the sense that all its possible values are equally likely)

By using a $(k,n)$ threshold scheme with $n=2k-1$ we get a very robust key management scheme:

our opponents cannot reconstruct the key even when security breaches expose $\lfloor n/2 \rfloor = k-1$ of the remaining $k$ pieces.

Our scheme is based on polynomial interpolation:

Knowledge of just $k-1$ of these values, on the other hand, does not suffice in order to calculate $D$.

Let us now assume that $k-1$ of these $n$ pieces are 
revealed to an opponent. For each candidate value $D'$ in 
$[0, p)$ he can construct one and only one polynomial 
$q'(x)$ of degree $k- 1$ such that $q'(0) =D'$ and $q'(i) =D_i$ 
for the $k- 1$ given arguments. By construction, these $p$ 
possible polynomials are equally likely, and thus there is 
absolutely nothing the opponent can deduce about the 
real value of $D$. 

the smallest usable value of $p$ is $n + 1$ (there must be at least $n + 1$ distinct arguments in $[0, p)$ to evaluate $q(x)$ at). 



---


üìñ Katz, Jonathan, and Yehuda Lindell.¬†*Introduction to modern cryptography: principles and protocols*. Chapman and Hall/CRC, 2007.

üìñ Silverman, Joseph H., Jill Pipher, and Jeffrey Hoffstein.¬†*An introduction to mathematical cryptography*. Vol. 1. Springer New York, 2008.



### Secret Sharing Schemes

A Secret Sharing Scheme (SSS) provides a way of sharing a secret among several people.

In a true secret sharing scheme among a group of $n$ people, no subgroup of $n-1$ people should be able to gain an advantage in discovering the secret.

#### SSS for $n$ participants

For example, to share a secret $S\bmod m$ among $n$ people, select $n-1$ random numbers

$$
s_1,\ s_2,\ \ldots,\ s_{n-1}\mod m,
$$

and set

$$
s_n\equiv S -s_1- s_2- \cdots- s_{n-1}\mod m
$$

or simply

$$
s_n := S \oplus (\bigoplus_{i=1}^{n-1} s_i)
$$

over the binary vector space.

The $i$th participant receives the value of $s_i$, and it requires all $n$ values to recover the secret

$$
S\equiv s_1+ s_2+ \cdots+ s_{n-1}+ s_n\mod m.
$$

and

$$
S = \bigoplus_{i=1}^{n} s_i
$$

#### SSS for $t$ participants among $n$ people

Suppose that we want to share a secret among $n$ people in such a way that any $t$ of them can recover the secret, but no $t-1$ of them can do so: $(t, n)$ threshold sharing schemes, where $t$ is the threshold of the scheme.

##### When does it need?

A nuclear-launch code: Any $t$ users should be able to pool their shares and reconstruct the secret, but no coalition of fewer than $t$ users should get any information about $s$ from their collective shares (beyond whatever information they had about $s$ already).

##### Shamir‚Äôs SSS

- **COROLLARY** Any two distinct degree-$t$ polynomials $f$ and $g$ agree on at most $t$ points.
    
    **PROOF** If not, then the nonzero, degree-$t$ polynomial $f ‚àí g$ would have more than $t$ roots.
    

Shamir‚Äôs scheme relies on the fact that for any $t$ pairs of elements $(x_1, y_1),..., (x_t, y_t)$ from $\mathbb F$ (with the $\{x_i\}$ distinct), there is a unique polynomial $f$ of degree $t ‚àí 1$ such that $f(x_i) = y_i$ for $1\le i\le t$.

We can prove this quite easily.

It takes $k+1$ values to determine a polynomial of degree $k$.

Set $a_0=S$, choose random number $a_1, a_2, ..., a_{t-1}$, and form the polynomial

$$
f(x) = a_0+a_1 x+a_2 x^2 +\cdots+a_{t-1} x^{t-1}.
$$

Next, we choose $n$ random values for $x$, say $x_1, x_2, ..., x_n$, and compute

$$
y_i = f(x_i)\qquad\text{for }\ 1\le i\le n.
$$

The $i$th participant is given the value $y_i$.

After sharing their $y_i$, these $t$ participants can form the following system of equations:

$$
\begin{aligned}
y_1 &= f(x_1) = a_0 + a_1 x_1 + a_2 x_1^2 + \cdots + a_{t-1} x_1^{t-1}\\
y_2 &= f(x_2) = a_0 + a_1 x_2 + a_2 x_2^2 + \cdots + a_{t-1} x_2^{t-1}\\
\vdots & \qquad\qquad\qquad\qquad\qquad\quad\vdots \\
y_t &= f(x_t) = a_0 + a_1 x_t + a_2 x_t^2 + \cdots + a_{t-1} x_t^{t-1}
\end{aligned}
$$

The participants know all of the $x_i$ and $y_i$ values, so they know this system of $t$ linear equations for the $t$ unknown $a_0, a_1, ...,a_{t-1}$.

They can solve the system using Gaussian elimination to find the $a_j$ and thus recover the secret $a_0=S$.

In practice, a more efficient way to reconstruct $f(x)$ is to use what are known as Lagrange interpolation polynomials.

In detail: for $i = 1, ... , t$, define the degree-$(t ‚àí 1)$ polynomial

$$
‚Åç
$$

Note that $\delta_i(x_j)=0$ for any $j \neq i$, and $\delta_i(x_i)=1$. 

So

$$
f(X) \stackrel{\text{def}}{=} \sum_{i=1}^t \delta_i(X) \cdot y_i
$$

is a polynomial of degree $(t ‚àí 1)$ with $f(x_i) = y_i$ for $1 \le i \le t$.

Uniqueness follows from **COROLLARY**.

Let $\mathbb F$ be a finite field that contains the domain of possible secrets, and with $|{\mathbb F}| > N$.

Let $x_1, ... ,x_n \in \mathbb F$ be distinct, nonzero elements that are fixed and publicly known. 
(Such elements exist since $|{\mathbb F}| > N$.) 

The scheme works as follows:

- Sharing
    
    Given a secret $s \in\mathbb F$, the dealer chooses uniform $a_1, ... ,a_{t‚àí1}\in\mathbb F$ and defines the polynomial
    
    $$
    f(X) \stackrel{\text{def}}{=} s + \sum_{i=1}^{t-1} a_i X^i
    $$
    
    This is a uniform degree-$(t ‚àí 1)$ polynomial with constant term $s$.
    
    The share of user $P_i$ is $s_i := f(x_i) \in\mathbb F$.
    
- Reconstruction
    
    Say $t$ users $P_{i_1}, ... ,P_{i_t}$ pool their shares $s_{i_1}, ... , s_{i_t}$. 
    
    Using polynomial interpolation, they compute the unique degree-$(t ‚àí 1)$ polynomial $f'$ for which 
    
    $$
    f'(x_{i_j}) = s_{i_j}
    \qquad\text{for }\ 1 \le j \le t.
    $$
    
    The secret is $f'(0)$.
    
    It is clear that reconstruction works since $f'=f$ and $f(0) = s$.
    

It remains to show that any $t ‚àí 1$ users learn nothing about the secret $s$ from their shares.

### Verifiable Secret Sharing

We are also concerned about active, malicious behavior. 

There are two separate concerns:

- First, a corrupted dealer may give inconsistent shares to the users, i.e., such that different secrets are recovered depending on which $t$ users pool their shares.
- Second, in the reconstruction phase, a malicious user may present a different share from the one given to them by the dealer, and thus affect the recovered secret.
    
    (While this could be addressed by having the dealer sign the shares, this does not work when the dealer itself may be dishonest.) 
    

Verifiable secret-sharing (VSS) schemes prevent both these attacks.

More formally, we allow any $t-1$ users to be corrupted and to collude with each other and, possibly, the dealer. 

We require: 

1.  at the end of the sharing phase, a secret $s$ is defined such that any set of users that includes $t$ uncorrupted users will successfully recover $s$ in the reconstruction phase; 
        
    moreover, 
        
2. if the dealer is honest, then $s$ corresponds to the dealer‚Äôs secret. 

In addition, 

1. when the dealer is honest, then, as before, any set of $t-1$ corrupted users learns nothing about the secret from their shares and any public information the dealer publishes. 

Since we want there to be $t$ uncorrupted users even if $t-1$ users are corrupted, we require $n\ge t+(t-1)$ or $n>2t$;

in other words, we assume a majority of the users remain uncorrupted.

Let $H$ denote a function to be modeled as a random oracle. 

We also assume that some trusted parameters $({\mathbb G}, q, g)$, generated using ${\mathcal G}(1^n)$, are published in advance, where $q$ is prime and so $\mathbb{Z}_q$ is a field. 

Finally, we assume that all users have access to a broadcast channel, such that a message broadcast by any user is heard by everyone.

The sharing phase now involves the $N$ users running an interactive protocol with the dealer that proceeds as follows:

1. To share a secret $s$, the dealer chooses uniform $a_0 \in \mathbb{Z}_q$ and then shares $a_0$ as in Shamir‚Äôs scheme. 
    
    That is, the dealer chooses uniform $a_1,...,a_{t-1}\in\mathbb{Z}_q$ and defines the polynomial 
    
    $$
    f(X) \stackrel{\text{def}}{=} \; \sum_{j=0}^{t-1} a_j X^j.
    $$
    
    The dealer sends the share 
    
    $$
    s_i = f(x_i) =\; \sum_{j=0}^{t-1} a_j x_i^j.
    $$
    
    In addition, the dealer publicly broadcasts the values $A_0:= g^{a_0}, ... ,A_{t-1}:= g^{a_{t-1}}$, and the ‚Äúmasked secret‚Äù $c := H(a_0)\oplus s$.
    
2. Each user $P_i$ verifies that its share $s_i$ satisfies
    
    $$
    g^{s_i} = \prod_{j=0}^{t-1} (A_j)^{i^j}.
    $$
    
    If not, $P_i$ publicly broadcasts a complaint.
    
    Note that if the dealer is honest, we have
    
    $$
    \prod_{j=0}^{t-1} (A_j)^{i^j} = \prod_{j=0}^{t-1} (g^{a_j})^{i^j} = g^{\sum_{j=0}^{t-1} a_j \cdot i^j} = g^{p(i)} = g^{s_i},
    $$
    
    and so no honest user will complain. Since there are at most $t ‚àí 1$ corrupted users, there are at most $t‚àí1$ complaints if the dealer is honest.
    
3. If more than $t‚àí1$ users complain, 
    
    the dealer is disqualified and the protocol is aborted. 
    
    Otherwise, the dealer responds to a complaint from $P_i$ by broadcasting $s_i$. 
    
    1. If this share does not satisfy Equation (or if the dealer refuses to respond to a complaint at all), the dealer is disqualified and the protocol is aborted. 
    2. Otherwise, $P_i$ uses the broadcast value (rather than the value it received in the first round) as its share.

In the reconstruction phase, say a group of users (that includes at least $t$ uncorrupted users) pool their shares. A share $s_i$ provided by a user $P_i$ is discarded if it does not satisfy Equation. Among the remaining shares, any $t$ of them are used to recover $a_0$ exactly as in Shamir‚Äôs scheme. The original secret is then computed as $s = c \oplus H(a_0)$.

Combined with the fact that an honest dealer is never disqualified, this proves that conditions (1a) and (1b) hold.

Define $a_i := \log_g A_i$ for $0 \le i \le t-1$; the $\{a_i\}$ cannot be computed efficiently if the discrete-logarithm problem is hard, but they are still well-defined. Define the polynomial $p(X) \stackrel{\text{def}}{=}\sum_{i=0}^{t-1} a_i X^i$. 

Any share $s_i$, contributed by party $P_i$, that is not discarded during the reconstruction phase must satisfy Equation, and hence satisfies $s_i = p(i)$. It follows that, regardless of which shares are used, the parties will reconstruct polynomial $p$, compute $a_0 = p(0)$, and then recover $s = c \oplus H(a_0)$.

It is also possible to show that condition (2) holds for computationally bounded adversaries if the discrete-logarithm problem is hard for $\mathcal G$. (In contrast to Shamir‚Äôs secret-sharing scheme, secrecy here is no longer unconditional. Unconditionally secure VSS schemes are possible, but are beyond the scope of our treatment.) Intuitively, this is because the secret $s$ is masked by the random value $H(a_0)$, and the information given to any $t ‚àí 1$ users in the sharing phase‚Äînamely, their shares and the public values $\{A_i\}$‚Äîreveals only $g^{a_0}$, from which it is hard to compute $a_0$. This intuition can be made rigorous, but we do not do so here.