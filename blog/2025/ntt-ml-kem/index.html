<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="n8dLJYW35x7DJL8Qm6jd505pT0eW3ucsWsW4_GaH3MA"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> NTT ML-KEM | June </title> <meta name="author" content="Jieun Ryu"> <meta name="description" content="NTT(Number Theoretic Transform) for ML-KEM, ML-DSA"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' data: https:; media-src 'self' https:; frame-src 'self' https:; connect-src 'self' https:;"> <link rel="stylesheet" href="/june.github.io/assets/css/bootstrap.min.css?v=a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/june.github.io/assets/css/academicons.min.css?v=f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/june.github.io/assets/css/scholar-icons.css?v=62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/june.github.io/assets/css/jekyll-pygments-themes-github.css?v=591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/june.github.io/assets/img/whale.png?v=169c6de4639e20133f0d09309d538e58"> <link rel="stylesheet" href="/june.github.io/assets/css/main.css?v=d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ryuj1eun.github.io/june.github.io/blog/2025/ntt-ml-kem/"> <script src="/june.github.io/assets/js/theme.js?v=5fea5159b787642c1bbc1f334d60f883"></script> <link defer rel="stylesheet" href="/june.github.io/assets/css/jekyll-pygments-themes-native.css?v=5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/june.github.io/"> June </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/june.github.io/">ABOUT </a> </li> <li class="nav-item active"> <a class="nav-link" href="/june.github.io/blog/">BLOG </a> </li> <li class="nav-item "> <a class="nav-link" href="/june.github.io/til/">TIL </a> </li> <li class="nav-item "> <a class="nav-link" href="/june.github.io/publications/">PUBLICATIONS </a> </li> <li class="nav-item "> <a class="nav-link" href="/june.github.io/cv/">CV </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">SUB </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/june.github.io/books/">Books</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/june.github.io/projects/">Exhibitions</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="fa-solid fa-magnifying-glass"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-half-sun-moon" id="light-toggle-system"></i> <i class="fa-solid fa-moon" id="light-toggle-dark"></i> <i class="fa-solid fa-sun" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">NTT ML-KEM</h1> <p class="post-meta"> Created on December 16, 2025 </p> <p class="post-tags"> <a href="/june.github.io/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a> Â  Â· Â  <a href="/june.github.io/blog/tag/math"> <i class="fa-solid fa-hashtag fa-sm"></i> MATH</a> Â  <a href="/june.github.io/blog/tag/pqc"> <i class="fa-solid fa-hashtag fa-sm"></i> PQC</a> Â  <a href="/june.github.io/blog/tag/cryptography"> <i class="fa-solid fa-hashtag fa-sm"></i> Cryptography</a> Â  Â· Â  <a href="/june.github.io/blog/category/study"> <i class="fa-solid fa-tag fa-sm"></i> Study</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>ğŸ“š <strong>[MAIN]</strong> Liang, Zhichuang, and Yunlei Zhao. â€œNumber theoretic transform and its applications in lattice-based cryptosystems: A survey.â€Â <em>arXiv preprint arXiv:2211.13546</em>Â (2022).<br> ğŸ“š <strong>[Sub 1]</strong> Pollard, John M. â€œThe fast Fourier transform in a finite field.â€Â <em>Mathematics of computation</em>Â 25.114 (1971): 365-374.<br> ğŸ“š <strong>[Sub 2]</strong> Agarwal, Ramesh C., and C. Sidney Burrus. â€œNumber theoretic transforms to implement fast digital convolution.â€Â <em>Proceedings of the IEEE</em>Â 63.4 (2005): 550-560.<br> ğŸ“š <strong>[Sub 3]</strong> FÃ¼rer, Martin. â€œFaster integer multiplication.â€Â <em>Proceedings of the thirty-ninth annual ACM symposium on Theory of computing</em>. 2007.<br> ğŸ“š <strong>[Sub 4]</strong> Fraleigh, John B.Â <em>A first course in abstract algebra</em>. Pearson Education India, 2003.</p> <hr> <h3 id="ml-kemcrystals-kyber">ML-KEM(CRYSTALS-Kyber)</h3> <p>Kyber is an IND-CCA secure MLWE-based KEM from the lattice-based cryptography suite called â€œCryptographic Suite for Algebraic Lattices (CRYSTALS)â€.</p> <p>The Kyber uses a ring $\mathbb{Z}_q[x]/(x^n + 1)$ with $n = 256$ and $q = 3329$, which no longer satisfy $q \equiv 1 \pmod{2n}$, but $q \equiv 1 \pmod{n}$.</p> <h3 id="preliminary">Preliminary</h3> <h4 id="primitive-and-principal-root-of-unity">Primitive and Principal Root of Unity</h4> <p>Define $\psi$ is the primitive $k$-th root of unity in ring $R$</p> <p>$\iff$ $\psi^k=1$, and $\psi^i\neq 1,\; i=1,2,\ â€¦\,,\ k-1$.</p> <p>(i.e., $k$ is the least positive integer s.t. $\psi^k = 1$)</p> <h5 id="cyclotomic-polynomial">Cyclotomic polynomial</h5> <p>$n$-th cyclotomic polynomial $\phi_n(x)$ëŠ” primitive $n$-th roots of unityë“¤ë§Œì„ ê·¼ìœ¼ë¡œ ê°–ëŠ” ìµœê³ ì°¨í•­ ê³„ìˆ˜ê°€ 1ì¸ ë‹¤í•­ì‹ì„</p> \[\phi_n(x)=\prod_{1\le k&lt;n,\\[1em] \gcd(k,n)=1}(x-e^{2\pi ki/n})\] <h5 id="2n-th-cyclotomic-polynomial">2n-th cyclotomic polynomial</h5> <p>Let $n$ be a power of two, then $x^n +1$ is the $2n$-th cyclotomic polynomial.</p> <p>ì¦‰, $x^n +1$ì€ primitive $2n$-th roots of unityë“¤ë§Œì„ ê·¼ìœ¼ë¡œ ê°–ëŠ” ë‹¤í•­ì‹ì„</p> <h4 id="convolution">Convolution</h4> <ul> <li> <p><strong>Cyclic</strong> convolution</p> <p>Consider $\boldsymbol{c} = \boldsymbol{a} \cdot \boldsymbol{b} \in \mathbb{Z}_q[x]/(x^n - 1)$, then</p> \[\boldsymbol{c} = \sum_{k=0}^{n-1} c_k x^k,\\[.5em] \text{where } c_k = \sum_{i=0}^k a_i b_{k-i} + \sum_{i=k+1}^{n-1} a_i b_{n+k-i} \bmod q\quad (k = 0, 1, \dots, n - 1).\] <p>And $\boldsymbol{c}$ is referred to as the cyclic convolution (CC for short) of $\boldsymbol{a}$ and $\boldsymbol{b}$.</p> </li> <li> <p><strong>Negative wrapped</strong> convolution</p> <p>Consider $\boldsymbol{c} = \boldsymbol{a} \cdot \boldsymbol{b} \in \mathbb{Z}_q[x]/(x^n + 1)$, then</p> \[\boldsymbol c = \sum_{k=0}^{n-1} c_k x^k,\\[.5em] \text{where } c_k = \sum_{i=0}^k a_i b_{k-i} - \sum_{i=k+1}^{n-1} a_i b_{n+k-i} \bmod q \quad (k = 0, 1, \dots, n - 1).\] <p>Here, $\boldsymbol{c}$ is referred to as their negative wrapped convolution (NWC for short).</p> <p>â€» $x^{n+k} = x^n \cdot x^k \equiv \mathbf{(-1)} \cdot x^k = -x^k$</p> </li> </ul> <h3 id="ntt">NTT</h3> <h4 id="cyclic-convolution-based-ntt">Cyclic Convolution-based NTT</h4> <p>$n$-point CC-based NTT has two parameters.</p> <ul> <li>The length or the point $n$, where $n$ is a power of two.</li> <li> <p>The modulus $q$, where $q$ is a prime number satisfying $q \equiv 1 \pmod n$.</p> </li> <li> <p>It implies that the primitive $n$-th root of unity $\omega_n$ in $\mathbb{Z}_q$ exists.</p> <p>$\mathbb{Z}_q$ê°€ ì†Œìˆ˜ $q$ì— ëŒ€í•œ Fieldì´ë¯€ë¡œ,</p> <p>0ì„ ì œì™¸í•œ ê³±ì…ˆêµ° $\mathbb{Z}_q^* = {1, 2, \dots, q-1}$ì€ order$\,=q-1$ì¸ groupì´ë‹¤.</p> <p>$\mathbb{Z}_q$ì˜ ê³±ì…ˆêµ° $\mathbb{Z}_q^*$ëŠ” í•­ìƒ cyclic groupì´ë¯€ë¡œ,</p> <p>ì–´ë–¤ generator $g$ê°€ ì¡´ì¬í•˜ì—¬ $\mathbb{Z}_q^* = { g^1, g^2, \dots, g^{q-1} }$ì´ë‹¤.</p> <p>ì´ë•Œ $q \equiv 1 \pmod n$ì´ë¯€ë¡œ $n \mid (q-1)$ì´ê³ ,</p> <p>ë”°ë¼ì„œ $\Z_q$ì—ëŠ” order$\,=n$ì¸ cyclic subgroupì˜ generatorê°€ ì¡´ì¬í•œë‹¤.</p> <p>order$\,=n$ì¸ $x\in\Z_q$ëŠ” ë‹¤ìŒì„ ë§Œì¡±í•œë‹¤.</p> <ul> <li>$x^n \equiv 1 \pmod q$</li> <li>$0 &lt; k &lt; n$ ì¸ ëª¨ë“  $k$ì— ëŒ€í•´ $x^k \not\equiv 1 \pmod q$</li> </ul> <p>ì¦‰, $x$ëŠ” primitive $n$-th root of unityì´ë‹¤.</p> <p>ë”°ë¼ì„œ ì†Œìˆ˜ $q$ì— ëŒ€í•´ $q \equiv 1 \pmod n$ì´ë¼ë©´, $\mathbb{Z}_q$ì—ëŠ” primitive $n$-th root of unity <strong>$\omega_n$</strong>ê°€ ì¡´ì¬í•˜ë©°,</p> <p>íŠ¹íˆ, $\phi(n)$ê°œë§Œí¼ ì¡´ì¬í•œë‹¤.</p> </li> </ul> <p>The forward transform, denoted by NTT, is defined as: $\hat{\boldsymbol{a}} = \text{NTT}(\boldsymbol{a})$, where</p> \[\hat{a}_j = \sum_{i=0}^{n-1} a_i \omega_n^{ij} \bmod q \quad (j = 0, 1, \dots, n - 1).\] <ul> <li> <p>NTTì˜ matrix í‘œí˜„</p> \[NTT=\begin{bmatrix} \omega^{0\times0} &amp;\cdots &amp; \omega^{0\times j} &amp;\cdots&amp; \omega^{0\times(n-1)}\\ \vdots &amp; \ddots &amp; \vdots &amp; \ddots &amp; \vdots \\ \omega^{i\times0} &amp;\cdots &amp; \omega^{i\times j} &amp;\cdots&amp; \omega^{i\times(n-1)}\\ \vdots &amp; \ddots &amp; \vdots &amp; \ddots &amp; \vdots \\ \omega^{(n-1)\times0} &amp;\cdots &amp; \omega^{(n-1)\times j} &amp;\cdots&amp; \omega^{(n-1)\times(n-1)}\\ \end{bmatrix}\] </li> </ul> <p>The inverse transform, denoted by INTT, is defined as $\boldsymbol{a} = \text{INTT}(\hat{\boldsymbol{a}})$, where</p> \[a_i = n^{-1} \sum_{j=0}^{n-1} \hat{a}_j \omega_n^{-ij} \bmod q \quad (i = 0, 1, \dots, n - 1).\] <ul> <li> <p>INTTì˜ matrix í‘œí˜„</p> \[\begin{aligned} NTT^{-1}&amp;=\frac{1}{n}\begin{bmatrix} \;\omega^{-[0\times0]} &amp;\cdots &amp; \omega^{-[0\times j]} &amp;\cdots&amp; \omega^{-[0\times(n-1)]}\\ \vdots &amp; \ddots &amp; \vdots &amp; \ddots &amp; \vdots \\[.5em] \;\omega^{-[i\times0]} &amp;\cdots &amp; \omega^{-[i\times j]} &amp;\cdots&amp; \omega^{-[i\times(n-1)]}\\ \vdots &amp; \ddots &amp; \vdots &amp; \ddots &amp; \vdots \\[.5em] \;\omega^{-[(n-1)\times0]} &amp;\;\;\cdots\;\; &amp; \omega^{-[(n-1)\times j]} &amp;\cdots&amp; \omega^{-[(n-1)\times(n-1)]}\; \end{bmatrix}\\ &amp; =\frac{1}{n}\begin{bmatrix} \omega^{[0\times0] + (n/2)} &amp;\cdots &amp; \omega^{[0\times j] + (n/2)} &amp;\cdots&amp; \omega^{[0\times(n-1)] + (n/2)}\\ \vdots &amp; \ddots &amp; \vdots &amp; \ddots &amp; \vdots \\[.5em] \omega^{[i\times0] + (n/2)} &amp;\cdots &amp; \omega^{[i\times j] + (n/2)} &amp;\cdots&amp; \omega^{[i\times(n-1)] + (n/2)}\\ \vdots &amp; \ddots &amp; \vdots &amp; \ddots &amp; \vdots \\[.5em] \omega^{[(n-1)\times0] + (n/2)} \!\!\!\!&amp;\cdots &amp; \!\!\!\!\omega^{[(n-1)\times j] + (n/2)} \!\!\!\!&amp;\cdots&amp;\!\!\!\! \omega^{[(n-1)\times(n-1)] + (n/2)}\\ \end{bmatrix} \end{aligned}\] </li> </ul> <p>Note that the inverse transform can be implemented by replacing the $\omega_n$ in NTT procedure with $\omega_n^{-1}$, followed by multiplying by a scale factor $n^{-1}$.</p> <h5 id="prop-cyclic-convolution-property">Prop) Cyclic Convolution Property</h5> <p>Let $\boldsymbol{c}$ be the cyclic convolution of $\boldsymbol{a}$ and $\boldsymbol{b}$, then it holds that</p> \[\text{NTT}(\boldsymbol{c}) = \text{NTT}(\boldsymbol{a}\cdot\boldsymbol{b}) = \text{NTT}(\boldsymbol{a}) \circ \text{NTT}(\boldsymbol{b}).\] <h4 id="negative-wrapped-convolution-based-ntt">Negative Wrapped Convolution-based NTT</h4> <p>The modulus $q$ is set to be a prime number satisfying $q \equiv 1 \pmod{2n}$ such that</p> <ul> <li> <p>the primitive $2n$-th root of unity $\psi_{2n}$ in $\mathbb{Z}_q$ exists.</p> <p>[ì™œ $2n$-th root of unityë¥¼ êµ¬í•˜ëŠ”ê°€?]</p> <p>Negative Wrapped Convolutionì€ $\Z_q[x]/(x^n+1)$ì—ì„œ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ë¯€ë¡œ $x^n \equiv -1$ê°€ ë˜ëŠ” $x$ë¥¼ êµ¬í•´ì•¼ í•œë‹¤.</p> <p><code class="language-plaintext highlighter-rouge">n-th primitive roots of unityëŠ” x^n=1ì´ë¯€ë¡œ êµ¬í•˜ê³ ì í•˜ëŠ” ê·¼ì´ ì•„ë‹˜</code></p> <p>ì´ë•Œ $x$ëŠ” $x^{2n} \equiv 1$ì´ë¯€ë¡œ $q \equiv 1 \pmod{2n}$ë¡œ ì„¤ì •í•˜ë©´,</p> <p>$(\psi_{2n}^{n})^2\equiv 1\implies \psi_{2n}^{n}\equiv -1$ì¸ primitive $2n$-th root of unity $\psi_{2n}\in\Z_q$ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.</p> <p>ì´ë•Œ, $\psi_{2n}$ëŠ” primitiveì´ë¯€ë¡œ $k&lt;2n$ì— ëŒ€í•˜ì—¬ $\psi_{2n}^k\neq 1$ì´ë¯€ë¡œ $\psi_{2n}^n\equiv1$ì´ë‹¤.</p> <p>â€» $\mathbb{Z}<em>q[x]/(x^{2n}-1)$ì˜ primitive $2n$-th roots of unity $\psi</em>{2n}$</p> <p>ì¤‘êµ­ì¸ì˜ ë‚˜ë¨¸ì§€ ì •ë¦¬ì— ì˜í•´</p> \[\mathbb{Z}_q[x]/(x^{2n}-1) \;\cong\; \underbrace{\,\mathbb{Z}_q[x]/(x^n-1)}_{\text{Cyclic Convolution}} \;\times \; \underbrace{\,\mathbb{Z}_q[x]/(x^n+1)}_{\text{Negative Wrapped}}\] <p>ì´ê³ , $\mathbb{Z}<em>q[x]/(x^{2n}-1)$ì—ì„œ êµ¬í•œ $2n$ê°œ ê·¼ì€ ${ \psi</em>{2n}^0, \psi_{2n}^1, \psi_{2n}^2, \dots, \psi_{2n}^{2n-1} }$ì´ë‹¤.</p> <p>ì´ë•Œ, $k=0,1,\,â€¦\,,n-1$ì— ëŒ€í•˜ì—¬ $\psi_{2n}^{2k}$ëŠ”</p> \[(\psi_{2n}^{2k})^n = (\psi_{2n}^{2n})^k = 1^k = 1\] <p>ì´ë¯€ë¡œ $\mathbb{Z}<em>q[x]/(x^n-1)$ì˜ ê·¼ì´ ë˜ê³ , $\psi</em>{2n}^{2k+1}$ì€</p> \[(\psi_{2n}^{2k+1})^n = (\psi_{2n}^{2n})^k \cdot \psi_{2n}^n = 1 \cdot (-1) = -1\] <p>ì´ë¯€ë¡œ $\mathbb{Z}_q[x]/(x^n+1)$ì˜ ê·¼ì´ ëœë‹¤.</p> </li> </ul> <p>Take $\omega_n = \psi_{2n}^2 \bmod q$, and write</p> \[\boldsymbol{\psi} = (1, \psi_{2n}, \psi_{2n}^2, \dots, \psi_{2n}^{n-1}),\quad \boldsymbol{\psi}^{-1} = (1, \psi_{2n}^{-1}, \psi_{2n}^{-2}, \dots, \psi_{2n}^{-(n-1)}).\] <p>Define</p> \[\bar{\boldsymbol{a}} = \boldsymbol{\psi} \circ \boldsymbol{a},\text{ where } \bar{a}_i = \psi_{2n}^i a_i \\[.5em] \boldsymbol{a} = \boldsymbol{\psi}^{-1} \circ \bar{\boldsymbol{a}},\text{ where } a_i = \psi_{2n}^{-i} \bar{a}_i.\] \[\hat{\boldsymbol{a}} = \text{NTT}^\psi(\boldsymbol{a}) = \text{NTT}(\boldsymbol{\psi} \circ \boldsymbol{a}),\\[1em] \boldsymbol{a} = \text{INTT}^{\psi^{-1}}(\hat{\boldsymbol{a}}) = \boldsymbol{\psi}^{-1} \circ \text{INTT}(\hat{\boldsymbol{a}}).\] <p><code class="language-plaintext highlighter-rouge">matrix í‘œí˜„ì€ CCì™€ ë™ì¼ (psiê°€ ì•„ë‹Œ omega ì‚¬ìš©)</code></p> <p>More specifically, the forward transform $\hat{\boldsymbol{a}} = \text{NTT}^\psi(\boldsymbol{a})$ can be written as</p> \[\hat{a}_j = \sum_{i=0}^{n-1} a_i \psi_{2n}^i \omega_n^{ij} \bmod q \quad (j = 0, 1, \dots, n - 1).\] <p>The inverse transform $\boldsymbol{a} = \text{INTT}^{\psi^{-1}}(\hat{\boldsymbol{a}})$ can be written as</p> \[a_i = n^{-1} \psi_{2n}^{-i} \sum_{j=0}^{n-1} \hat{a}_j \omega_n^{-ij} \bmod q \quad (i = 0, 1, \dots, n - 1).\] <h5 id="prop-negative-wrapped-convolution-property">Prop) Negative Wrapped Convolution Property</h5> <p>Let $\boldsymbol{c}$ be the negative wrapped convolution of $\boldsymbol{a}$ and $\boldsymbol{b}$, then it holds that</p> \[\begin{aligned} \text{NTT}^\psi(\boldsymbol{c}) &amp; = \text{NTT}(\boldsymbol{\psi} \circ \boldsymbol{c})\\[.3em] &amp;=\text{NTT}(\boldsymbol{\psi} \circ (\underbrace{\boldsymbol{a}\cdot\boldsymbol{b}}_\text{NWC}))\\[.3em] &amp;=\text{NTT}(\underbrace{(\boldsymbol{\psi} \circ\boldsymbol{a})\cdot (\boldsymbol{\psi} \circ\boldsymbol{b})}_{\text{CC\; }\because\ \psi_{wn}^{2k+1}\,\to\ \psi_{wn}^{2k+2}})\\[.3em] &amp;=\text{NTT}(\boldsymbol{\psi} \circ\boldsymbol{a})\circ\text{NTT}(\boldsymbol{\psi} \circ\boldsymbol{b})\\[.3em] &amp;=\text{NTT}^\psi(\boldsymbol{a}) \circ \text{NTT}^\psi(\boldsymbol{b}). \end{aligned}\] <ul> <li> <p>Example</p> <p><strong>Initialization</strong></p> <ul> <li>$\Z_q[x]/(x^n+1)$ <ul> <li>$n=2$, modulus $x^2 + 1$ (ì¦‰, $x^2 \equiv -1$)</li> <li>$q=5$ ($q \equiv 1 \pmod{2n}$ ë§Œì¡±)</li> </ul> </li> <li> <p>$\psi=2$</p> <p>$2^1=2,\; 2^2=4,\; 2^3=8\equiv3,\; 2^4=16\equiv1$, $\psi^n \equiv -1 \pmod q$</p> </li> <li>$\omega=4$</li> <li>NTT matrix $N = \begin{bmatrix} 1 &amp; 1 \ 1 &amp; \omega \end{bmatrix} = \begin{bmatrix} 1 &amp; 1 \ 1 &amp; 4 \end{bmatrix}$</li> <li>$\boldsymbol{a} = [1, 1]$ (ì¦‰, $x+1$)</li> <li>$\boldsymbol{b} = [2, 1]$ (ì¦‰, $x+2$)</li> </ul> <p><strong>Calculation</strong> (ë²¡í„°í‘œí˜„ê³¼ ë§ì¶”ê¸° ìœ„í•´ ë‹¤í•­ì‹ì„ ì €ì°¨í•­ë¶€í„° í‘œê¸°)</p> <p>$\boldsymbol{\psi}=[ \psi^0, \psi^1 ] = [1, 2]$</p> <ol> <li> <p>$\text{NTT}^\psi(\boldsymbol{c}) :=\text{NTT}(\boldsymbol{\psi} \circ \boldsymbol{c})=\text{NTT}(\boldsymbol{\psi} \circ (\boldsymbol{a}\cdot\boldsymbol{b}))$</p> <p>$\boldsymbol{c}=(1+x)(2+x) = 2 + 3x + x^2\equiv 2 + 3x + (-1) = 1+3x \implies[1,3]$</p> <p>$\boldsymbol{\psi} \circ \boldsymbol{c}=[1,2]\circ[1,3]=[1,6]\equiv[1,1]$</p> \[\text{NTT}(\boldsymbol{\psi} \circ \boldsymbol{c})=N([1,1])=\begin{bmatrix} 1 &amp; 1 \\ 1 &amp; 4 \end{bmatrix}\begin{bmatrix} 1 \\ 1 \end{bmatrix}=\begin{bmatrix} 2 \\ 5 \end{bmatrix}\equiv\begin{bmatrix} 2 \\ 0 \end{bmatrix}=[2,0]\] <p>$\boldsymbol{a}\cdot \boldsymbol{b}=\boldsymbol{c}=[1,3]$</p> <p>$\text{NTT}(\boldsymbol{\psi} \circ (\boldsymbol{a}\cdot \boldsymbol{b}))=[2,0]$</p> </li> <li> <p>$\text{NTT}((\boldsymbol{\psi} \circ\boldsymbol{a})\cdot (\boldsymbol{\psi} \circ\boldsymbol{b}))$</p> <p>â€» $\boldsymbol{\psi}$ë¥¼ ê³±í•´ì¤¬ê¸° ë•Œë¬¸ì— Cyclic convolution ê³µê°„ì´ ë¨ â‡’ $x^2\equiv 1$</p> <p>$\boldsymbol{\psi} \circ \boldsymbol{a}=[1,2]\circ[1,1]=[1,2]\implies1+2x$</p> <p>$\boldsymbol{\psi} \circ \boldsymbol{b}=[1,2]\circ[2,1]=[2,2]\implies 2+2x$</p> \[\begin{aligned} (\boldsymbol{\psi} \circ\boldsymbol{a})\cdot (\boldsymbol{\psi} \circ\boldsymbol{b}) &amp;=(1+2x)(2+2x)=2+4x+2x+4x^2\\ &amp;=2+6x+4(1)=6+6x\\ &amp;\equiv 1+x\implies [1,1] \end{aligned}\] \[\text{NTT}((\boldsymbol{\psi} \circ\boldsymbol{a})\cdot (\boldsymbol{\psi} \circ\boldsymbol{b}))=N([1,1])=\begin{bmatrix} 1 &amp; 1 \\ 1 &amp; 4 \end{bmatrix}\begin{bmatrix} 1 \\ 1 \end{bmatrix}=\begin{bmatrix} 2 \\ 5 \end{bmatrix}\equiv\begin{bmatrix} 2 \\ 0 \end{bmatrix}=[2,0]\] </li> <li> <p>$\text{NTT}(\boldsymbol{\psi} \circ\boldsymbol{a})\circ\text{NTT}(\boldsymbol{\psi} \circ\boldsymbol{b}) := \text{NTT}^\psi(\boldsymbol{a}) \circ \text{NTT}^\psi(\boldsymbol{b})$</p> \[\text{NTT}(\boldsymbol{\psi} \circ \boldsymbol{a})=N([1,2])=\begin{bmatrix} 1 &amp; 1 \\ 1 &amp; 4 \end{bmatrix}\begin{bmatrix} 1 \\ 2 \end{bmatrix}=\begin{bmatrix} 3 \\ 9 \end{bmatrix}\equiv\begin{bmatrix} 3 \\ 4 \end{bmatrix}=[3,4]\] \[\text{NTT}(\boldsymbol{\psi} \circ \boldsymbol{b})=N([2,2])=\begin{bmatrix} 1 &amp; 1 \\ 1 &amp; 4 \end{bmatrix}\begin{bmatrix} 2 \\ 2 \end{bmatrix}=\begin{bmatrix} 4 \\ 10 \end{bmatrix}\equiv\begin{bmatrix} 4 \\ 0 \end{bmatrix}=[4,0]\] \[\text{NTT}(\boldsymbol{\psi} \circ \boldsymbol{a})\circ \text{NTT}(\boldsymbol{\psi} \circ \boldsymbol{b})=[3,4]\circ[4,0]=[12,0]=[2,0]\] </li> </ol> </li> </ul> <h4 id="ntt-based-polynomial-multiplication">NTT-based Polynomial Multiplication</h4> <h5 id="cyclic-convolution-based-polynomial-multiplication">Cyclic convolution-based polynomial multiplication</h5> <p>To compute the cyclic convolution $\boldsymbol{c} = \boldsymbol{a} \cdot \boldsymbol{b} \in \mathbb{Z}_q[x]/(x^n - 1)$,</p> <p>one can straightly use $n$-point NTT/INTT, according to cyclic convolution property</p> \[\boldsymbol{c} = \text{INTT}(\text{NTT}(\boldsymbol{a}) \circ \text{NTT}(\boldsymbol{b})).\] <h5 id="negative-wrapped-convolution-based-polynomial-multiplication">Negative wrapped convolution-based polynomial multiplication</h5> <p>To compute the negative wrapped convolution $\boldsymbol{c} = \boldsymbol{a} \cdot \boldsymbol{b} \in \mathbb{Z}_q[x]/(x^n + 1)$, one can use the negative wrapped convolution property</p> \[\boldsymbol{c} = \text{INTT}^{\psi^{-1}}\left(\text{NTT}^\psi(\boldsymbol{a}) \circ \text{NTT}^\psi(\boldsymbol{b})\right).\] <h5 id="advantages-of-ntt">Advantages of NTT</h5> <p>Here, let NTT/INTT be any kind of forward/inverse transforms.</p> <ul> <li> <p>Firstly, both NTT and INTT are linear transformations, based on which INTTs can be saved in lattice-based schemes (e.g., Kyber and Dilithium), i.e.,</p> \[\begin{aligned} \sum_{i=0}^l \boldsymbol{a}_i \boldsymbol{b}_i &amp;= \sum_{i=0}^l \text{INTT}(\text{NTT}(\boldsymbol{a}_i) \circ \text{NTT}(\boldsymbol{b}_i)) \\ &amp;= \text{INTT}(\sum_{i=0}^l \text{NTT}(\boldsymbol{a}_i) \circ \text{NTT}(\boldsymbol{b}_i)). \end{aligned}\] </li> </ul> <h4 id="fft-trick-for-nwc-based-ntt-over-mathbbz_qxxn--1">FFT Trick for NWC-based NTT over $\mathbb{Z}_q[x]/(x^n + 1)$</h4> <p>The FFT trick to compute $\text{NTT}^\psi$ and $\text{INTT}^{\psi^{-1}}$ over $\mathbb{Z}_q[x]/(x^n + 1)$,</p> <p>where $n$ is a power of two and $q$ is a prime number satisfying $q \equiv 1 \pmod{2n}$.</p> <p>Since $\psi_{2n}^{n/2} \equiv -1 \pmod q$,</p> \[â.\] <p>As for $\text{NTT}^\psi$, the forward FFT trick implies that we have the following isomorphism</p> \[\mathbb{Z}_q[x]/(x^n + 1) \;\cong\; \mathbb{Z}_q[x]/(x^{n/2} - \psi_{2n}^{n/2}) \times \mathbb{Z}_q[x]/(x^{n/2} + \psi_{2n}^{n/2})\] <p>Notice that $x^n + 1$ has $n$ distinct roots in $\mathbb{Z}<em>q$, i.e., $\psi</em>{2n}^{2i+1}, i = 0, 1, \dots, n-1$.</p> <p>Therefore, there is a CRT isomorphism similarly.</p> \[\mathbb{Z}_q[x]/(x^n + 1) \;\cong\; \prod_{i=0}^{n-1} \mathbb{Z}_q[x]/(x - \psi_{2n}^{2\text{brv}_n(i)+1}).\] <p><img src="/june.github.io/assets/img/post_ntt_ml_kem/image.png" alt="image"> </p> <p>After the $k$-th level, where $0 \le k &lt; \log n$, it produces</p> \[\qquad\mathbb{Z}_q[x]/(x^{n/2^{k+1}} \pm \psi_{2n}^{\text{brv}_n(2^k+i)})\] <p>with pairs of rings.</p> <h5 id="example">Example</h5> <p>$n=8 \Rightarrow 2n=16$</p> <p>Let $\psi_{2n}$ is a primitive $2n$-th root of unity: i.e., $\psi_{2n}^{2n}=1$</p> <p><img src="/june.github.io/assets/img/post_ntt_ml_kem/image_1.png" alt="image"> </p> <p>Let $\omega=\psi_{2n}^2$, then $\omega$ is a primitive $n$-th root of unity: $\omega^{n}= (\psi_{2n}^2)^{n}=1$</p> <p><img src="/june.github.io/assets/img/post_ntt_ml_kem/image_2.png" alt="image"> </p> <p><img src="/june.github.io/assets/img/post_ntt_ml_kem/image_3.png" alt="image"> </p> <h4 id="radix-2-fast-nwc-based-ntt">Radix-2 Fast NWC-based NTT</h4> <p>The Cooley-Tukey butterfly or CT butterfly<code class="language-plaintext highlighter-rouge">Multiplication â†’ Addition</code>.</p> <p><img src="/june.github.io/assets/img/post_ntt_ml_kem/14416731-2c31-4e01-9c81-ca220167df77.png" alt="image"> </p> <p>Gentlemen-Sande butterfly or GS butterfly<code class="language-plaintext highlighter-rouge">Addition â†’ Multiplication</code>.</p> <p><img src="/june.github.io/assets/img/post_ntt_ml_kem/bc9e4c46-c1a8-4888-8f28-8fab825d7c10.png" alt="image"> </p> <p>The process of multiplying the coefficients by $\psi_{2n}^i$ before forward transform is referred to as pre-processing.</p> <p><img src="/june.github.io/assets/img/post_ntt_ml_kem/image_4.png" alt="image"> </p> <p><img src="/june.github.io/assets/img/post_ntt_ml_kem/image_5.png" alt="image"> </p> <ol> <li> <p><strong>Cooley-Tukey algorithm for $\text{NTT}^\psi$</strong></p> <p>According to the definition of $\text{NTT}^\psi$, the coefficients of $\hat{\boldsymbol{a}}$ can be written as</p> \[\hat{a}_j = \sum_{i=0}^{n-1} a_i \psi_{2n}^i \omega_n^{ij} \bmod q, \quad j = 0, 1, \dots, n - 1.\] <p>For $j = 0, 1, \dots, n - 1$,</p> \[\begin{aligned} \hat{a}_j &amp;= \sum_{i=0}^{n/2-1} a_{2i} \omega_n^{2ij} \psi_{2n}^{2i} + \sum_{i=0}^{n/2-1} a_{2i+1} \omega_n^{(2i+1)j} \psi_{2n}^{2i+1} \bmod q \\[1.5em] &amp;= \sum_{i=0}^{n/2-1} a_{2i} (\omega_n^2)^{ij} (\psi_{2n}^2)^i + \omega_n^j \psi_{2n} \sum_{i=0}^{n/2-1} a_{2i+1} (\omega_n^2)^{ij} (\psi_{2n}^2)^i \bmod q. \end{aligned}\] <p>Based on the periodicity and symmetry of the primitive root of unity, for $j = 0, 1, \dots, n/2 - 1$</p> \[\begin{aligned} \hat{a}_j &amp;= \sum_{i=0}^{n/2-1} a_{2i} (\omega_n^2)^{ij} (\psi_{2n}^2)^i + \omega_n^j \psi_{2n} \sum_{i=0}^{n/2-1} a_{2i+1} (\omega_n^2)^{ij} (\psi_{2n}^2)^i \bmod q \\[1.5em] \hat{a}_{j+n/2} &amp;= \sum_{i=0}^{n/2-1} a_{2i} (\omega_n^2)^{ij} (\psi_{2n}^2)^i - \omega_n^j \psi_{2n} \sum_{i=0}^{n/2-1} a_{2i+1} (\omega_n^2)^{ij} (\psi_{2n}^2)^i \bmod q. \end{aligned}\] <p>Let</p> \[\begin{aligned} \hat{a}'_j &amp;= \sum_{i=0}^{n/2-1} a_{2i} (\omega_n^2)^{ij} (\psi_{2n}^2)^i \bmod q,\\[1.5em] \hat{a}''_j &amp;= \sum_{i=0}^{n/2-1} a_{2i+1} (\omega_n^2)^{ij} (\psi_{2n}^2)^i \bmod q. \end{aligned}\] <p>With $\omega_n^j \psi_{2n} = \psi_{2n}^{2j+1}$,</p> \[\hat{a}_j = \hat{a}'_j + \psi_{2n}^{2j+1} \hat{a}''_j \bmod q, \quad \hat{a}_{j+n/2} = \hat{a}'_j - \psi_{2n}^{2j+1} \hat{a}''_j \bmod q.\] <p>One can see that, $\hat{a}â€™_j$ and $\hat{a}â€™â€˜_j$ can be obtained via exact $n/2$-point $\text{NTT}^\psi$s.</p> </li> <li> <p><strong>Gentleman-Sande algorithm for $\text{INTT}^{\psi^{-1}}$</strong></p> <p>According to the definition of $\text{INTT}^{\psi^{-1}}$, the coefficients of $\boldsymbol{a}$ can be written as</p> \[a_i = n^{-1} \psi_{2n}^{-i} \sum_{j=0}^{n-1} \hat{a}_j \omega_n^{-ij} \bmod q, \quad i = 0, 1, \dots, n - 1.\] <p>With neglecting $n^{-1}$, for $i = 0, 1, \dots, n - 1$,</p> \[\begin{aligned} a_i &amp;= \psi_{2n}^{-i} \left( \sum_{j=0}^{n/2-1} \hat{a}_j \omega_n^{-ij} + \sum_{j=n/2}^{n-1} \hat{a}_j \omega_n^{-ij} \right) \\[1.5em] &amp;= \psi_{2n}^{-i} \left[ \sum_{j=0}^{n/2-1} \hat{a}_j \omega_n^{-ij} + \sum_{j=0}^{n/2-1} \hat{a}_{j+n/2} \omega_n^{-i(j+n/2)} \right] \bmod q. \end{aligned}\] <p>Based on the periodicity and symmetry of the primitive root of unity, for $i = 0, 1, \dots, n/2 - 1$,</p> \[\begin{aligned} a_{2i} &amp;= \psi_{2n}^{-2i} \left[ \sum_{j=0}^{n/2-1} \hat{a}_j \omega_n^{-2ij} + (-1)^{2i} \cdot \sum_{j=0}^{n/2-1} \hat{a}_{j+n/2} \omega_n^{-2ij} \right] \bmod q \\[1.5em] &amp;= (\psi_{2n}^2)^{-i} \sum_{j=0}^{n/2-1} (\hat{a}_j + \hat{a}_{j+n/2}) (\omega_n^2)^{-ij} \bmod q, \\[2em] a_{2i+1} &amp;= \psi_{2n}^{-(2i+1)} \left[ \sum_{j=0}^{n/2-1} \hat{a}_j \omega_n^{-(2i+1)j} + (-1)^{2i+1} \cdot \sum_{j=0}^{n/2-1} \hat{a}_{j+n/2} \omega_n^{-(2i+1)j} \right] \bmod q \\[1.5em] &amp;= (\psi_{2n}^2)^{-i} \sum_{j=0}^{n/2-1} \left[ (\hat{a}_j - \hat{a}_{j+n/2}) \cdot \omega_n^{-j} \psi_{2n}^{-1} \right] (\omega_n^2)^{-ij} \bmod q. \end{aligned}\] <p>Since $\omega_n^{-j} \psi_{2n}^{-1} = \psi_{2n}^{-(2j+1)}$, letting</p> \[\begin{aligned} \hat{b}'_j &amp;= \hat{a}_j + \hat{a}_{j+n/2} \bmod q,\\[1em] \hat{b}''_j &amp;= (\hat{a}_j - \hat{a}_{j+n/2}) \cdot \psi_{2n}^{-(2j+1)} \bmod q,\quad j = 0, 1, \dots, n/2 - 1, \end{aligned}\] <p>the above formula can be rewritten as, for $i = 0, 1, \dots, n/2 - 1$,</p> \[\begin{aligned} a_{2i} &amp;= (\psi_{2n}^2)^{-i} \sum_{j=0}^{n/2-1} \hat{b}'_j (\omega_n^2)^{-ij} \bmod q, \\[1.5em] a_{2i+1} &amp;= (\psi_{2n}^2)^{-i} \sum_{j=0}^{n/2-1} \hat{b}''_j (\omega_n^2)^{-ij} \bmod q. \end{aligned}\] <p>Computing $n$-point $\text{INTT}^{\psi^{-1}}$ can be transformed into two $n/2$-point $\text{INTT}^{\psi^{-1}}$s with respect to $\hat{b}â€™_j, \hat{b}â€™â€˜_j$.</p> <p>Forthermore, $\boldsymbol{\psi}^{-1}$ and $n^{-1}$ can both be integrated into $\text{INTT}^{GS}_{bo \to no}$.</p> <p>Thus, for $i = 0, 1, \dots, n/2 - 1$,</p> \[\begin{aligned} a_{2i} &amp;= \left(\frac{n}{2}\right)^{\!\!-1}\! (\psi_{2n}^2)^{-i} \sum_{j=0}^{n/2-1} \hat{b}'_j (\omega_n^2)^{-ij} \bmod q, \\[1.5em] a_{2i+1} &amp;= \left(\frac{n}{2}\right)^{\!\!-1}\! (\psi_{2n}^2)^{-i} \sum_{j=0}^{n/2-1} \hat{b}''_j (\omega_n^2)^{-ij} \bmod q, \end{aligned}\\[.7em] \begin{aligned} \text{where }\; &amp; \hat{b}'_j = (\hat{a}_j + \hat{a}_{j+n/2})/2 \mod q,\\[.5em]&amp; \hat{b}''_j = (\hat{a}_j - \hat{a}_{j+n/2})/2 \cdot \psi_{2n}^{-(2j+1)} \bmod q, \quad j = 0, 1, \dots, n/2 - 1. \end{aligned}\] </li> </ol> <h3 id="kyber-ntt">Kyber NTT</h3> <aside> ğŸ’¡ 1. Kyber ringì€ $\Z_q[x]/(x^n+1)$ì´ë¯€ë¡œ NWC-based NTTë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ primitive $2n$-th root of unityê°€ í•„ìš”í•¨ - $2n$-th root of unity $\psi_{2n}$ëŠ” $\psi_{2n}^{2n}=1$ì´ë¯€ë¡œ $\psi_{2n}^n=-1\implies x^n+1=x^n-(\psi_{2n}^n)=0$ì„ ë§Œì¡±í•¨ 2. Primitive $2n$-th root of unityê°€ ì¡´ì¬í•˜ë ¤ë©´ 1. $n=2^k$ 2. $q\equiv 1\pmod{2n}$ ì„ ë§Œì¡±í•´ì•¼ í•¨ 3. KyberëŠ” $n=256=2^8$ì´ì§€ë§Œ $q$ì— ëŒ€í•˜ì—¬ $q\equiv 257\neq 1\pmod{512}$ì´ë¯€ë¡œ $2n$-th root of unityê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ 4. Kyber ring $\Z_q[x]/(x^{256}+1)$ì„ $(\Z_q[y]/(y^2-x))[x]/(x^{128}+1)$ë¡œ ë³€í™˜í•¨ 1. $n'=128$ì— ëŒ€í•˜ì—¬ primitive $2n$-th root of unityê°€ ì¡´ì¬í•¨ 2. FFTë¥¼ ì ìš©í•œ point-wise multiplicationì€ $(c_0 +c_1 y)(c_0' +c_1' y)\in \Z_q[y]/(y^2-x)$ë¡œì¨ ìˆ˜í–‰ë¨ </aside> <h5 id="full-nwc-based-ntt-ì ìš©-ë¶ˆê°€">Full NWC-based NTT ì ìš© ë¶ˆê°€</h5> <p>Full NWC-based NTTëŠ” ë‹¤ìŒì„ ë§Œì¡±í•´ì•¼ í•¨</p> \[n=2^k\quad\text{ and }\quad q\equiv1\;(\bmod{\;2n})\] <p>íŠ¹íˆ, Full NWC-based NTTëŠ”</p> \[\mathbb{Z}_q[x]/(x^n + 1) \;\cong\; \prod_{i=0}^{n-1} \mathbb{Z}_q[x]/(x - \psi_{2n}^{2\text{brv}_n(i)+1})\] <p>ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì´ë¯€ë¡œ primitive $2n$-th root of unity $\psi_{2n}$ê°€ ì¡´ì¬í•´ì•¼ ì ìš© ê°€ëŠ¥í•¨</p> <p>Kyberì˜ specì€ ë‹¤ìŒê³¼ ê°™ìŒ</p> \[n=256=2^8\quad\text{ and }\quad q\equiv1\;(\bmod{\;256})\quad\text{ but }\quad q\neq 1\;(\bmod{\;512})\] <p>ì´ëŠ” $\Z_q$ ìƒì— primitive 256-th root of unityëŠ” ì¡´ì¬í•˜ì§€ë§Œ, primitive 512-th root of unityëŠ” ì¡´ì¬í•˜ì§€ ì•ŠìŒì„ ì˜ë¯¸</p> <h4 id="truncated-nttë¥¼-ì´ìš©í•œ-í•´ê²°">Truncated NTTë¥¼ ì´ìš©í•œ í•´ê²°</h4> <h5 id="incomplete-fft-trick-truncated-ntt">Incomplete FFT trick (Truncated NTT)</h5> <p>Incomplete FFT trickì€ FFT depth level $\beta$ì— ëŒ€í•˜ì—¬ ë‹¤í•­ì‹ ring êµ¬ì¡°ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë³€í™˜í•¨</p> \[\mathbb{Z}_q[x]/(x^n+1) \cong \prod_{i=0}^{n/2^\beta - 1} \mathbb{Z}_q[x] / (x^{2^\beta} - \psi_{2n/2^\beta}^{2\text{brv}(i)+1})\] <ul> <li>$\beta$ëŠ” $\log n$-levelì˜ NTTë¥¼ $\beta$-level ì´ì „ì— ë§ˆì¹¨ì„ ì˜ë¯¸í•¨</li> </ul> <p>$\beta$ëŠ”</p> \[q \equiv 1 \pmod{2n/2^{\beta}}\] <p>ë¥¼ ë§Œì¡±í•˜ë„ë¡ ì„ íƒí•˜ë©°, KyberëŠ” íš¨ìœ¨ì„±ì„ ìœ„í•´ ê°€ì¥ ì‘ì€ $\beta=1$ì„ ì„ íƒí•¨</p> \[q=3329 \equiv 1\quad(\bmod{\;256}=\bmod{\;{2n}/2})\] <p>KyberëŠ” $\beta=1$ì¸ Incomplete FFT trickì„ ì‚¬ìš©í•˜ë¯€ë¡œ</p> \[\mathbb{Z}_q[x]/(x^n+1) \cong \prod_{i=0}^{n/2 - 1} \mathbb{Z}_q[x] / (x^{2} - \psi_{n}^{2\text{brv}(i)+1})\] <p>ë¡œ ring êµ¬ì¡°ë¥¼ ë³€í™˜í•¨</p> <p>ì´ëŠ” Kyber ringì—ì„œ ì •ì˜ëœ ë‹¤í•­ì‹ $a(x)\in \Z_q[x]/(x^n+1)$ë¥¼ $y = x^{2^\beta} = x^2$ë¡œ ì¹˜í™˜í•˜ì—¬ $y$ì— ëŒ€í•œ ë‹¤í•­ì‹</p> \[\begin{aligned} a(y) = \sum_{i=0}^{n/2^\beta -1} \tilde{a}_i y^i &amp;\in \left(\mathbb{Z}_q[x]/(x^{2^\beta} - y)\right)[y]/(y-\psi_{2n/2^\beta}^{2\text{brv}_{n/2^\beta}(i)+1}) \\[1.5em] \text{ where }\quad \tilde{a}_i=\sum_{j=0}^{2^\beta -1}a_{2^\beta i+j} x^j &amp;\in \mathbb{Z}_q[x]/(x^{2^\beta} - y) \end{aligned}\] <p>ì¦‰,</p> \[\begin{aligned} a(y) = \sum_{i=0}^{n/2 -1} \tilde{a}_i y^i &amp;\in \left(\mathbb{Z}_q[x]/(x^{2} - y)\right)[y]/(y-\psi_{n}^{2\text{brv}_{n/2}(i)+1}) \\[1.5em] \text{ where }\quad \tilde{a}_i=\sum_{j=0}^{1}a_{2i+j} x^j &amp;\in \mathbb{Z}_q[x]/(x^{2} - y) \end{aligned}\] <p>ë¡œ í‘œí˜„í•¨ì„ ì˜ë¯¸í•¨</p> <p>ì´ëŠ”</p> \[\mathbb{Z}_q[x]/(x^n+1) \cong \prod_{i=0}^{n/2^\beta - 1} \mathbb{Z}_q[x] / (x^{2^\beta} - \psi_{2n/2^\beta}^{2\text{brv}(i)+1})\] <p>ì—ì„œ ìµœìƒìœ„ levelì—ì„œì˜ ring êµ¬ì¡°ë¥¼</p> \[\mathbb{Z}_q[x]/(x^n+1) \to \left(\Z_q[x]/(x^{2^\beta} - y)\right)[y]/(y^{n/2^\beta} +1)\] <p>ë¡œ ë°”ë¼ë³´ëŠ” ê²ƒì„</p> <p>$n=256,\ \beta=1$ì— ëŒ€í•˜ì—¬</p> \[\mathbb{Z}_q[x]/(x^{256}+1) \to \left(\Z_q[x]/(x^{2} - y)\right)[y]/(y^{128} +1)\] <p>ì´ë©°,</p> <p>ì´ëŠ” ìµœìƒìœ„ levelì˜ ring êµ¬ì¡°ë¥¼ $y$ì— ëŒ€í•˜ì—¬ ê³„ìˆ˜ê°€ 1ì°¨ ë‹¤í•­ì‹ $c_0+c_1 x$ì¸ 127ì°¨ ë‹¤í•­ì‹ìœ¼ë¡œ ë³´ëŠ” ê²ƒì„</p> <p>KyberëŠ” ìœ„ êµ¬ì¡°ì—ì„œ $y$ì— ëŒ€í•œ 128-point Full NWC-based NTTë¥¼ ìˆ˜í–‰í•¨</p> \[\mathbb{Z}_q[x]/(x^{256}+1) \to \left(\Z_q[x]/(x^{2} - y)\right)[y]/(y^{128} +1)\] <p>ë˜í•œ, formal variable $x, y$ë¥¼ êµí™˜í•˜ë©´</p> \[\mathbb{Z}_q[x]/(x^{256}+1) \to \left(\Z_q[y]/(y^{2} - x)\right)[x]/(x^{128} +1)\] <p>ì´ë¯€ë¡œ, NTTë¥¼ ì ìš©í•  ë‹¤í•­ì‹ì„ $c_0+c_1 y$ í˜•íƒœì˜ ê³„ìˆ˜ë¥¼ ê°–ëŠ” $x$ì— ëŒ€í•œ ë‹¤í•­ì‹ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆìŒ</p> <p>ì´ë•Œ $\omega=\psi_{2n/2}=\psi_{n}$ì´ë©°, $\omega_i:=\omega^i$ë¼ê³  í•  ë•Œ ë‹¤í•­ì‹ $\boldsymbol{a}$ëŠ” ë‹¤ìŒìœ¼ë¡œ ë§¤í•‘ë¨</p> \[\begin{aligned} \mathbb{Z}_q[x]/(x^{256}+1) &amp;\cong \prod_{i=0}^{127} \mathbb{Z}_q[x] / (x^2 - \omega_i) \\[1.5em]&amp;\cong \prod_{i=0}^{127} \left(\mathbb{Z}_q[y]/(y^{2} - x)\right)[x]/ (x^2 - \omega_i) \end{aligned}\] <p><img src="/june.github.io/assets/img/post_ntt_ml_kem/image_6.png" alt="image"> </p> <h4 id="ë‹¤í•­ì‹-ê³±ì…ˆì„-ìœ„í•œ-ntt-ì„ íƒ">ë‹¤í•­ì‹ ê³±ì…ˆì„ ìœ„í•œ NTT ì„ íƒ</h4> <p>KyberëŠ” NWC-based NTT ì—°ì‚°ì„ ì ìš©í•´ì•¼ í•˜ë¯€ë¡œ</p> \[\text{NTT}^{CT,\psi}_{no\,\to\, bo}\quad\text{ and }\quad\text{INTT}^{GS,\psi^{-1}}_{bo\,\to\, no}\] <p>ë¥¼ ì‚¬ìš©í•¨</p> <p>Point-wise multiplicationì€</p> \[a(x), b(x) \in \mathbb{Z}_q[x]/(x^2 - \omega_i)\] <p>ì— ëŒ€í•˜ì—¬ (formal variable $y\to x$)</p> \[c(x) = a(x)b(x) \pmod{x^2 - \omega_i}\] <p>ì„ êµ¬í•˜ëŠ” ê³¼ì •ì´ë©°</p> \[\begin{aligned} (a_0 + a_1x)(b_0 + b_1x) &amp;= a_0b_0 + (a_0b_1 + a_1b_0)x + a_1b_1x^2\\ &amp;\equiv (a_0b_0 + a_1b_1\omega^2) + (a_0b_1 + a_1b_0)x \pmod{x^2 - \omega_i} \end{aligned}\] <p>ìœ¼ë¡œ êµ¬í•  ìˆ˜ ìˆìŒ</p> <h3 id="algorithm-analysis">Algorithm analysis</h3> <h5 id="boldalgorithm--color0000ffsf-nttf">$\bold{Algorithm} \ \color{#0000ff}{\sf NTT}(f)$</h5> <p>Computes the NTT representation $\hat f$ of the given polynomial $f\in R_q$.</p> <p>${\bf{Input}}: {\rm array}\ f\in\mathbb{Z}_q^{256}.$</p> <p>${\bf{Output}}: {\rm array}\ \hat{f}\in\mathbb{Z}_q^{256}.$</p> <p>$01: \hat{f}\leftarrow f$</p> <p>$02: i\leftarrow 1$</p> <p>$03: {\bf for}({\rm len} \leftarrow 128\ ;\ {\rm len}\ge 2\ ;\ {\rm len}/2)$</p> <p>$04: \quad {\bf for} ({\rm start} \leftarrow 0\ ;\ {\rm start}&lt;256\ ;\ {\rm start}\leftarrow {\rm start}!+!2!\cdot!{\rm len})$</p> <p>$05: \qquad {\rm zeta} \leftarrow \zeta^{\color{0000ff} {\sf BitRev}_7(i)} \mod q$</p> <p>$06: \qquad i\leftarrow i!+!1$</p> <p>$07: \qquad {\bf for} (j\leftarrow {\rm start}\ ;\ j&lt;{\rm start+len}\ ;\ j\text{++})$</p> <p>$08: \quad\qquad t \leftarrow {\rm zeta}\cdot\hat{f}[j+\rm len]\mod q$</p> <p>$09: \quad\qquad \hat{f}[j+\rm len] \leftarrow \hat{f}[j]-t\mod q$</p> <p>$10: \quad\qquad \hat{f}[j] \leftarrow \hat{f}[j]+t\mod q$</p> <p>$11: \qquad {\bf endfor}$</p> <p>$12: \quad {\bf endfor}$</p> <p>$13: {\bf endfor}$</p> <p>$14: {\bf return}\ \hat{f}$</p> <h4 id="truncation">Truncation</h4> <ul> <li> <p>Algorithm line 3: len=128, 64, â€¦ ,2</p> <p>â‡’ Crops with $\beta=1$</p> <p>Full NWC-based NTTëŠ” $2^0\sim2^7$ê¹Œì§€ $\log 2^8=8$-levelì˜ NTTë¥¼ ìˆ˜í–‰í•˜ì§€ë§Œ</p> <p>KyberëŠ” $\beta=1$-levelì¸ $\text{len}=2^0$ì— ëŒ€í•œ ë¶„í•´ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•ŠìŒ</p> </li> <li> <p>Line 8~10</p> <p>â‡’ Point-wise multiplication over $\Z_q[x]/(x^2-\zeta)$ for $\zeta=\omega_i$</p> \[\left(\ \sum_{i=0}^{1} \hat{a}_i x^i\right)\left(\ \sum_{i=0}^{1} \hat{b}_i x^i\right) =(\hat{a}_0 x^0+\hat{a}_1 x^1)(\hat{b}_0 x^0+\hat{b}_1 x^1) \mod({x^{2} - \zeta}),\] </li> </ul> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2026 Jieun Ryu. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: February 20, 2026. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/june.github.io/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/june.github.io/assets/js/masonry.js?v=a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/june.github.io/assets/js/zoom.js?v=85ddb88934d28b74e78031fd54cf8308"></script> <script src="/june.github.io/assets/js/no_defer.js?v=2781658a0a2b13ed609542042a859126"></script> <script defer src="/june.github.io/assets/js/common.js?v=c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/june.github.io/assets/js/copy_code.js?v=c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/june.github.io/assets/js/jupyter_new_tab.js?v=d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/june.github.io/assets/js/mathjax-setup.js?v=a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/june.github.io/assets/js/progress-bar.js?v=2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/june.github.io/assets/js/vanilla-back-to-top.min.js?v=f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/june.github.io/assets/js/search/ninja-keys.min.js?v=a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/june.github.io/assets/js/search-setup.js?v=6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/june.github.io/assets/js/search-data.js"></script> <script src="/june.github.io/assets/js/shortcut-key.js?v=ccc841c459bfc0e64c1c2b5acd10df02"></script> <script type="text/javascript">
      // ìš°í´ë¦­ ë°©ì§€
      document.oncontextmenu = function() {
        return false;
      };

      // ë“œë˜ê·¸ ë° ì„ íƒ ë°©ì§€
      document.onselectstart = function() {
        return false;
      };

      // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ë°©ì§€ (F12, Ctrl+Shift+I ë“± ê°œë°œì ë„êµ¬ ë° ë³µì‚¬ ë°©ì§€)
      document.onkeydown = function(e) {
        if (e.ctrlKey && (e.keyCode === 67 || e.keyCode === 86 || e.keyCode === 85 || e.keyCode === 83)) {
          return false; // Ctrl+C, Ctrl+V, Ctrl+U(ì†ŒìŠ¤ë³´ê¸°), Ctrl+S ë°©ì§€
        }
      };
    </script> </body> </html>